# SuperCellCyto-analysis

This repository contains the code to reproduce all the analysis done for our paper
introducing the `SuperCellCyto` R package: https://github.com/phipsonlab/SuperCellCyto.

`SuperCellCyto` is an adaptation of the [SuperCell R package](https://github.com/GfellerLab/SuperCell). 
Initially developed for scRNAseq data, the SuperCell package aggregates cells 
with similar transcriptomic profiles into "supercells" (also known as “metacells” in the scRNAseq literature).

## Contents

To reproduce all the figures in the paper, refer to the `Rmd` files in the `analysis` folder:

* `explore_supercell_purity_clustering` for 
Supercells Preserve Biological Heterogeneity and Facilitate Efficient Cell Type Identification
* `b_cells_identification` for Identifying Rare B Cells Subsets by Clustering Supercells
* `batch_correction` for Mitigating Batch Effects in the Integration of Multi-Batch Cytometry Data at the Supercell Level
* `de_test` for Recovery of Differentially Expressed Cell State Markers Across Stimulated and Unstimulated Human Peripheral Blood Cells
* `da_test` for Identification of Differentially Abundant Rare Monocyte Subsets in Melanoma Patients
* `label_transfer` for Efficient Cell Type Label Transfer Between CITEseq and Cytometry Data
* `run_time` for measuring the run time of SuperCellCyto and clustering process applicable for 
the first 3 items above.

The `code` folder contains the scripts used to generate the raw results that are
processed in the `Rmd` files in the `analysis` folder.
Please note that running some of these scripts will take a long time. 

The `data` and `output` folders are meant for storing raw data and processed data 
generated by the scripts in the `code` folder respectively.
The content of these folders are purposely not committed into the repository 
as they are enormous (over 40GB in total).
If you would like to reproduce our analysis, please download the content
from this cloud storage [TBC link] and place the files in your copy of `data` and `output` folder
before running `wflow_build()`.
Note, do not rename any folders or files, or move the folders around.



